<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 3. Obtaining the Code and Setting up the development environment</title><meta content="DocBook XSL Stylesheets V1.68.1" name="generator" /><link rel="start" href="index.html" title="OpenCMISS Programmer Documentation" /><link rel="up" href="index.html" title="OpenCMISS Programmer Documentation" /><link rel="prev" href="ch02.html" title="Chapter 2. OpenCMISS Concepts" /><link rel="next" href="ch04.html" title="Chapter 4. Object Interface" /></head><body><div class="navheader"><table summary="Navigation header" width="100%"><tr><th align="center" colspan="3">Chapter 3. Obtaining the Code and Setting up the development environment</th></tr><tr><td align="left" width="20%"><a accesskey="p" href="ch02.html">Prev</a> </td><th align="center" width="60%"> </th><td align="right" width="20%"> <a accesskey="n" href="ch04.html">Next</a></td></tr></table><hr /></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="N10059" />Chapter 3. Obtaining the Code and Setting up the development environment</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="ch03.html#N1005C">1. Obtaining the Code</a></span></dt><dt><span class="sect1"><a href="ch03.html#N1007C">2. Project Set up</a></span></dt><dd><dl><dt><span class="sect2"><a href="ch03.html#N1007F">2.1. On AIX 5.3</a></span></dt><dt><span class="sect2"><a href="ch03.html#N1008A">2.2. On Ubuntu 8.04</a></span></dt><dt><span class="sect2"><a href="ch03.html#N100BB">2.3. On Windows XP (Visual Studio 2005)</a></span></dt><dt><span class="sect2"><a href="ch03.html#N100EC">2.4. On Windows Vista (Visual Studio 2008)</a></span></dt></dl></dd></dl></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="N1005C" />1. Obtaining the Code</h2></div></div></div><p>
      To obtain the openCMISS source you need to check it out from the subversion repository. There are two parts to openCMISS to obtain - openCMISS itself and the various libraries it needs.
    </p><div class="literallayout"><p><span style="white-space: pre;">To check out the main trunk of openCMISS issue the following commands:<span><strong class="command">
      cd place-where-you-want-to-put-your-working-copy
      mkdir opencmiss
      cd opencmiss
      svn co https://opencmiss.svn.sourceforge.net/svnroot/opencmiss/cm/trunk cm</strong></span></span></p></div><div class="literallayout"><p><span style="white-space: pre;">To check out the main trunk of the various libraries required with openCMISS issue the following commands:<span><strong class="command">
      cd place-where-you-want-to-put-your-working-copy
      mkdir opencmissextras
      cd opencmissextras
      svn co http://www.physiome.ox.ac.uk/svn/opencmissextras/cm/trunk/external/architecture cm/external/architecture</strong></span></span></p></div><p>
      where architecture is the appropriate architecture for the machine. Possible architectures are:
    </p><div class="itemizedlist"><ul type="disc"><li>i386-win32</li><li>i386-win32-debug</li><li>i686-linux</li><li>i686-linux-debug</li><li>x86_64-linux</li><li>x86_64-linux-debug</li><li>rs6000-32-aix</li><li>rs6000-32-aix-debug</li></ul></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="N1007C" />2. Project Set up</h2></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="N1007F" />2.1. On AIX 5.3</h3></div></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="N10082" />2.1.1. Set environment</h4></div></div></div>
        Set environment variable to point to openCMISS
        Set environment variable to point to openCMISS-extras
      </div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="N10086" />2.1.2. Compile</h4></div></div></div>
        Change directory to opencmiss/cm
        Use gmake.
        This should result in a binary that you can run, but you will need to set-up for MPI (hosts file etc).
        The main program is in opencmisstest.f90.
      </div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="N1008A" />2.2. On Ubuntu 8.04</h3></div></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="N1008D" />2.2.1. Set environment</h4></div></div></div><p>Set environment variable to point to opencmiss</p><span><strong class="command">setenv OPENCMISS_ROOT=&lt;path for your opencmiss folder&gt;</strong></span><p>Set environment variable to point to opencmiss-extras</p><span><strong class="command">setenv OPENCMISSEXTRAS_ROOT=&lt;path for your opencmissextras folder&gt;</strong></span><p>Add opencmiss and opencmiss extra paths</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="N1009A" />2.2.2. Install Compilers</h4></div></div></div><p>Install Intel Fortran Compiler</p><p>Extract the file and follow the install.htm to install</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="N100A2" />2.2.3. Install MPI</h4></div></div></div><p>Install MPICH2</p><p>Extract the file and follow the README to install</p><p>Remember to set the path</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="N100AC" />2.2.4. Compile</h4></div></div></div><p>To build the project:</p><span><strong class="command">make</strong></span><p>To run the project:</p><span><strong class="command">mpd &amp; mpirun -n 2 path/to/the/execution/file</strong></span><p>To debug the project using TotalView:</p><span><strong class="command">mpd &amp; mpirun -tv 2 path/to/the/execution/file</strong></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="N100BB" />2.3. On Windows XP (Visual Studio 2005)</h3></div></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="N100BE" />2.3.1. Set environment</h4></div></div></div><p>Modify the Fortran project properties for the link to OpenCMISS-extra</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="N100C3" />2.3.2. Install Compilers</h4></div></div></div><p>Install Intel Fortran Compiler</p><p>Execute the exe file and follow the installation wizard, you night need to have direct access to internet to install</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="N100CB" />2.3.3. Install MPI</h4></div></div></div><p>Install MPICH2</p><p>You can either download the source archive and follow the README.windows file to install or download the installer to install.</p><p>Set bin folder to the path</p><p>To start the MPI, run smpd -start</p><p>NOTE: as from MPICH2 version 1.0.7 the library names have changed. libmpich2 has now become libmpi!</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="N100D9" />2.3.4. Compile and Debug</h4></div></div></div><p>Build the Fortran project under the debug mode and generate the opencmisstest-debug.exe file.</p><p>In the C Project (since the Fortran projects do not support MPI cluster debugger), configure the debugging properties according to this.</p><p>The MPIShim location is in the path similar to C:\Program Files\Microsoft Visual Studio 8\Common7\IDE\Remote Debugger\x86\mpishim.exe.</p><p>Debug the C project.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="N100E5" />2.3.5. Run</h4></div></div></div><p>To run the project in the command window:</p><span><strong class="command">mpiexec -n 2 -localroot bin\i386-win32\opencmisstest-debug.exe</strong></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="N100EC" />2.4. On Windows Vista (Visual Studio 2008)</h3></div></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="N100EF" />2.4.1. Install Compilers</h4></div></div></div><p>Install Intel Fortran Compiler</p><p>Execute the exe file and follow the installation wizard, you night need to have direct access to internet to install</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="N100F7" />2.4.2. Install MPI</h4></div></div></div><p>Before you install MPICH2 under Vista you must turn off User Account Control</p><div class="orderedlist"><ol type="1"><li>Goto Start -&gt; Control Panel</li><li>Double-click on User Accounts</li><li>Click "Turn User Account Control on or off"</li><li>Untick "Use User Account Control (UAC) to help protect your computer" and click OK</li><li>Restart your computer.</li></ol></div><p>Download from here. Choose the Win32 IA32 (binary) option.</p><p>Run the downloaded .msi file. Follow all instructions and install "For everybody".</p><p>Once you have installed MPICH2 you can turn User Account Control back on. Follow the instructions above and in 4. tick the "Use User Account Control ...".</p><p>NOTE: as from MPICH2 version 1.0.7 the library names have changed. libmpich2 has now become libmpi!</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="N10110" />2.4.3. Optional: Compiling PETSc</h4></div></div></div><p>Note this is assuming you have the Intel Fortran compiler version 10.1.024. Adjust the version string as necessary.</p><div class="itemizedlist"><ul type="disc"><li>Install Cygwin if you need to. Cywin can be found here. Make sure you include the make and python modules when you install.</li><li>Lauch a Command Prompt Window</li><li>Run the ifortvars.bat batch file to setup your Intel Fortran environment. e.g., "C:\Program Files\Intel\Compiler\Fortran\10.1.024\IA32\Bin\ifortvars.bat"</li><li>Run the Cygwin batch file to setup the unix environment e.g., "C:\Cygwin\Cygwin.bat"</li><li>Change to the opencmissextras PETSc directory e.g., if opencmissextras root is E:\opencmissextras and we are compiling PETSC version petsc-2.3.3-p8 then "cd /cygwin/e/opencmissextras/cm/external/packages/PETSc/petsc-2.3.3-p8"</li><li>If you have MPICH2 version 1.0.7 or greater edit the python/BuildSystem/config/packages/MPI.py file. Find the self.liblist_mpich line. After the line "['fmpich2.lib','mpich2.lib']," add the line "['fmpich2.lib','mpi.lib'],".</li><li>Compile and Install PETSC:</li></ul></div><p>For a debug install issue the following commands</p><span><strong class="command">
          <p>PETSC_DIR=/cygdrive/e/opencmissextras/cm/external/packages/PETSc/petsc-2.3.3-p8; export PETSC_DIR</p>
          <p>PETSC_ARCH=cygwin-c-debug; export PETSC_ARCH</p>
          <p>config/configure.py --prefix=/cygdrive/e/opencmissextras/cm/external/i386-win32-debug --with-shared=no --with-cc='win32fe cl' --with-fc='win32fe ifort' --with-cxx='win32fe cl' --download-f-blas-lapack=1 LIBS=-L'/cygdrive/c/Program\ Files/Intel/Compiler/Fortran/10.1.024/IA32/Lib' --with-debugging=yes</p>
          <p>PETSC_ARCH=cygwin-c-debug; export PETSC_ARCH</p>
          <p>make -e all</p>
          <p>make -e install</p>
        </strong></span><p>For a non-debug install issue the following commands</p><span><strong class="command">
          <p>PETSC_DIR=/cygdrive/e/opencmissextras/cm/external/packages/PETSc/petsc-2.3.3-p8; export PETSC_DIR</p>
          <p>PETSC_ARCH=cygwin-c-opt; export PETSC_ARCH</p>
          <p>config/configure.py --prefix=/cygdrive/e/opencmissextras/cm/external/i386-win32 --with-shared=no --with-cc='win32fe cl' --with-fc='win32fe ifort' --with-cxx='win32fe cl' --download-f-blas-lapack=1 LIBS=-L'/cygdrive/c/Program\ Files/Intel/Compiler/Fortran/10.1.024/IA32/Lib' --with-debugging=no</p>
          <p>PETSC_ARCH=cygwin-c-opt; export PETSC_ARCH</p>
          <p>make -e all</p>
          <p>make -e install</p>
        </strong></span></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="N10150" />2.4.4. Compile</h4></div></div></div><p>Go to the openCMISS/cm directory that you have downloaded openCMISS from SVN into. Go into the VisualopenCMISS_08 folder. Double click the VisualopenCMISS project solution file to lauch Visual Studio.</p></div></div></div></div><div class="navfooter"><hr /><table summary="Navigation footer" width="100%"><tr><td align="left" width="40%"><a accesskey="p" href="ch02.html">Prev</a> </td><td align="center" width="20%"> </td><td align="right" width="40%"> <a accesskey="n" href="ch04.html">Next</a></td></tr><tr><td valign="top" align="left" width="40%">Chapter 2. OpenCMISS Concepts </td><td align="center" width="20%"><a accesskey="h" href="index.html">Home</a></td><td valign="top" align="right" width="40%"> Chapter 4. Object Interface</td></tr></table></div></body></html>