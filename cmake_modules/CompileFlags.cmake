IF(NOT DEFINED MPI)
  SET(MPI mpich2)
ENDIF(NOT DEFINED MPI)

IF(NOT DEFINED USECELLML)
  SET(USECELLML false)
ENDIF(NOT DEFINED USECELLML)

IF(${MPI} MATCHES mpich2)
  SET(MPI mpich2)
ELSEIF(${MPI} MATCHES intel)
  IF (${OPERATING_SYSTEM} MATCHES linux)
    IF(DEFINED I_MPI_ROOT)
      SET(MPI intel)
    ELSE(DEFINED I_MPI_ROOT)
      MESSAGE(FATAL_ERROR "Intel MPI libraries not setup")
    ENDIF(DEFINED I_MPI_ROOT)
  ELSE(${OPERATING_SYSTEM} MATCHES linux)
    MESSAGE(FATAL_ERROR "can only use intel mpi with Linux")
  ENDIF(${OPERATING_SYSTEM} MATCHES linux)
ELSEIF(${MPI} MATCHES openmpi)
  SET(MPI openmpi)
ELSEIF(${MPI} MATCHES mvapich2)
  SET(MPI mvapich2)
ELSEIF(${MPI} MATCHES cray)
  SET(MPI cray)
ELSE(${MPI} MATCHES mpich2)
  MESSAGE( FATAL_ERROR "unknown MPI type - ${MPI}")
ENDIF(${MPI} MATCHES mpich2)

IF(${MPIPROF} MATCHES "true")
  IF($(MPI) MATCHES intel)
    IF(NOT DEFINED VT_ROOT)
      MESSAGE(FATAL_ERROR "Intel MPI libraries not setup")
    ENDIF(NOT DEFINED VT_ROOT)
    IF(NOT DEFINED VT_ADD_LIBS)
      MESSAGE(FATAL_ERROR "intel trace collector not setup")
    ENDIF(NOT DEFINED VT_ADD_LIBS)
  ENDIF($(MPI) MATCHES intel)
ENDIF(${MPIPROF} MATCHES "true")

IF(${MPI} MATCHES mpich2)
  SET(MPIFC mpif90)
  SET(MPICC mpicc)
ELSE(${MPI} MATCHES mpich2)
  SET(MPIFC mpiifort)
  SET(MPICC mpiicc)
ENDIF(${MPI} MATCHES mpich2)
SET(FC ${MPIFC})
SET(CC ${MPICC})
SET(AR ar)
SET(EXE_LINK ${FC})
SET(DSO_LINK ld)
